View(terveys.m)
bmi.mediaani.m <- median(terveys.m$bmi)
bmi.mediaani.n <- median(terveys.n$bmi)
bmi.q025.m <- quantile(terveys.m$bmi, 0.25, type=2)
bmi.q075.m <- quantile(terveys.m$bmi, 0.75, type=2)
bmi.q075.n <- quantile(terveys.n$bmi, 0.75, type=2)
bmi.q025.n <- quantile(terveys.n$bmi, 0.25, type=2)
# Miesten ja naisten bmi kvartiilit
bmi.q025.m <- quantile(terveys.m$bmi, 0.25, type=2)
bmi.q025.n <- quantile(terveys.n$bmi, 0.25, type=2)
bmi.q075.m <- quantile(terveys.m$bmi, 0.75, type=2)
bmi.q075.n <- quantile(terveys.n$bmi, 0.75, type=2)
# Tukeyn laatikot
boxplot(terveys.m$bmi)
boxplot(terveys.n$bmi)
# Tukeyn laatikot
par(mfrow=c(1,2))
boxplot(terveys.m$bmi)
boxplot(terveys.n$bmi)
par(mfrow=c(1,2))
boxplot(terveys.m$bmi, main="Miesten BMI")
boxplot(terveys.n$bmi, main="Naisten BMI")
boxplot(terveys.m$bmi, terveys.n$bmi, main="Miesten BMI")
# Tukeyn laatikot
boxplot(terveys.m$bmi, terveys.n$bmi, ylab="BMI")
# Tukeyn laatikot
boxplot(terveys.m$bmi, terveys.n$bmi, ylab="BMI")
# Tukeyn laatikot
boxplot(terveys.m$bmi, terveys.n$bmi, c("Miehet", "Naiset"), ylab="BMI")
# Tukeyn laatikot
boxplot(terveys.m$bmi, terveys.n$bmi, names=c("Miehet", "Naiset"), ylab="BMI")
qqnorm(exp_otos)
qqline(exp_otos)
# Katsotaan viela, miten eksp.jakauman vinous ilmenee
# Tukeyn laatikkokuviossa:
boxplot(exp_otos)
n <- 50  # otoskoko (kokeile erisuuria!)
norm_otos <- rnorm(n)  # normaalijakauma N(0,1)
hist(norm_otos,breaks=10)
qqnorm(norm_otos)
qqline(norm_otos)  # suora (voi olla avuksi)
exp_otos <- rexp(n)  # eksponenttijakauma Exp(1)
hist(exp_otos,breaks=20)
qqnorm(exp_otos)
qqline(exp_otos)
# Katsotaan viela, miten eksp.jakauman vinous ilmenee
# Tukeyn laatikkokuviossa:
boxplot(exp_otos)
tasa_otos <- runif(n)  # tasajakauma valilla (0,1)
hist(tasa_otos,breaks=10)
qqnorm(tasa_otos)
qqline(tasa_otos)
hist(norm_otos,breaks=10)
qqnorm(norm_otos)
qqline(norm_otos)  # suora (voi olla avuksi)
exp_otos <- rexp(n)  # eksponenttijakauma Exp(1)
hist(exp_otos,breaks=20)
qqnorm(exp_otos)
qqline(exp_otos)
# Katsotaan viela, miten eksp.jakauman vinous ilmenee
# Tukeyn laatikkokuviossa:
boxplot(exp_otos)
tasa_otos <- runif(n)  # tasajakauma valilla (0,1)
hist(tasa_otos,breaks=10)
qqnorm(tasa_otos)
qqline(tasa_otos)
# Normaalikvantiilikuviot kaikille
qqnorm(terveys$bmi)
qqline(terveys$bmi)
# Normaalikvantiilikuviot miehille
qqnorm(terveys.m$bmi)
qqline(terveys.m$bmi)
# Normaalikvantiilikuviot naisille
qqnorm(terveys.n$bmi)
qqline(terveys.n$bmi)
par(mfrow=c(3,1))
par(mfrow=c(3,1))
# Normaalikvantiilikuviot kaikille
qqnorm(terveys$bmi)
qqline(terveys$bmi)
# Normaalikvantiilikuviot miehille
qqnorm(terveys.m$bmi)
qqline(terveys.m$bmi)
# Normaalikvantiilikuviot naisille
qqnorm(terveys.n$bmi)
qqline(terveys.n$bmi)
# Normaalikvantiilikuviot kaikille
qqnorm(terveys$bmi)
qqline(terveys$bmi)
par(mfrow=c(2,1))
# Normaalikvantiilikuviot miehille
qqnorm(terveys.m$bmi)
qqline(terveys.m$bmi)
# Normaalikvantiilikuviot naisille
qqnorm(terveys.n$bmi)
qqline(terveys.n$bmi)
help("qqnorm")
# Normaalikvantiilikuviot miehille
qqnorm(terveys.m$bmi, main = "Normaalikvantiilikuviot miehille")
qqline(terveys.m$bmi)
# Normaalikvantiilikuviot naisille
qqnorm(terveys.n$bmi, main = "Normaalikvantiilikuviot naisille")
qqline(terveys.n$bmi)
# Normaalikvantiilikuviot miehille
qqnorm(terveys.m$bmi, main = "Normaalikvantiilikuvio miehille")
qqline(terveys.m$bmi)
# Normaalikvantiilikuviot naisille
qqnorm(terveys.n$bmi, main = "Normaalikvantiilikuvio naisille")
qqline(terveys.n$bmi)
help("qqnorm")
# Normaalikvantiilikuviot miehille
qqnorm(terveys.m$bmi, main = "Normaalikvantiilikuvio miehille")
qqline(terveys.m$bmi)
# Normaalikvantiilikuviot naisille
qqnorm(terveys.n$bmi, main = "Normaalikvantiilikuvio naisille")
qqline(terveys.n$bmi)
# Normaalikvantiilikuviot miehille
qqnorm(terveys.m$bmi, main = "Normaalikvantiilikuvio miehille", ylim = 50)
# Normaalikvantiilikuviot miehille
qqnorm(terveys.m$bmi, main = "Normaalikvantiilikuvio miehille", ylim = 50)
qqline(terveys.m$bmi)
# Normaalikvantiilikuviot naisille
qqnorm(terveys.n$bmi, main = "Normaalikvantiilikuvio naisille")
qqline(terveys.n$bmi)
help(qqnorm)
# Normaalikvantiilikuviot miehille
qqnorm(terveys.m$bmi, 50, main = "Normaalikvantiilikuvio miehille")
# Normaalikvantiilikuviot miehille
qqnorm(terveys.m$bmi, main = "Normaalikvantiilikuvio miehille")
qqline(terveys.m$bmi)
# Normaalikvantiilikuviot naisille
qqnorm(terveys.n$bmi, main = "Normaalikvantiilikuvio naisille")
qqline(terveys.n$bmi)
terveys <- read.csv("C:/Users/Marko/OneDrive - O365 Turun yliopisto/UTU/Tilastollisen päättelyn peruskurssi/viikko1/terveys.csv",sep=";")
View(terveys)
terveys$bmi  <- terveys$paino/(terveys$pituus/100)^2
View(terveys)
vinous  <- function(x) {
n <- length(x)# havaintojen  lkm
ka <- mean(x)# otoskeskiarvo
(1/n)*sum((x-ka)^3) / ((1/n)*sum((x-ka )^2))^(3/2)
}
terveys <- read.csv("C:/Users/Marko/OneDrive - O365 Turun yliopisto/UTU/Tilastollisen päättelyn peruskurssi/viikko1/terveys.csv",sep=";")
terveys$bmi  <- terveys$paino/(terveys$pituus/100)^2
vinous  <- function(x) {
n <- length(x)# havaintojen  lkm
ka <- mean(x)# otoskeskiarvo
(1/n)*sum((x-ka)^3) / ((1/n)*sum((x-ka )^2))^(3/2)
}
vinous(terveys$sukupuoli)
vinous(terveys$pituus)
vinous(terveys$paino)
vinous(terveys$kolesteroli)
vinous(terveys$ika)
vinous(terveys$bmi)
vinous(terveys$pituus)
vinous(terveys$paino)
vinous(terveys$kolesteroli)
vinous(terveys$ika)
vinous(terveys$bmi)
huipukkuus(terveys$pituus)
huipukkuus <- function(x) {
n <- length(x) # havaintojen  lkm
ka <- mean(x) # otoskeskiarvo
(((1/n)*sum((x-ka)^4)) / (((1/n)*sum((x-ka)^2)))^2) - 3
}
huipukkuus(terveys$pituus)
huipukkuus(terveys$paino)
huipukkuus(terveys$kolesteroli)
huipukkuus(terveys$ika)
huipukkuus(terveys$bmi)
terveys <- read.csv("C:/Users/Marko/OneDrive - O365 Turun yliopisto/UTU/Tilastollisen päättelyn peruskurssi/viikko1/terveys.csv",sep=";")
View(terveys)
terveys$bmi  <- terveys$paino/(terveys$pituus/100)^2
terveys.m <- subset(terveys, sukupuoli =="Mies")
terveys.n <- subset(terveys, sukupuoli =="Nainen")
# Miesten ja naisten bmi-mediaanit
median(terveys.m$bmi)
median(terveys.n$bmi)
# Miesten ja naisten bmi kvartiilit
quantile(terveys.m$bmi, 0.25, type=2)
quantile(terveys.n$bmi, 0.25, type=2)
quantile(terveys.m$bmi, 0.75, type=2)
quantile(terveys.n$bmi, 0.75, type=2)
help("quantile")
# Tukeyn laatikot
boxplot(terveys.m$bmi, terveys.n$bmi, names=c("Miehet", "Naiset"), ylab="BMI")
# Normaalikvantiilikuviot kaikille
qqnorm(terveys$bmi)
qqline(terveys$bmi)
# Normaalikvantiilikuviot kaikille
qqnorm(terveys$bmi, main="Normaalikvantiilikuvio terveys$bmi")
qqline(terveys$bmi)
par(mfrow=c(2,1))
# Normaalikvantiilikuviot miehille
qqnorm(terveys.m$bmi, main = "Normaalikvantiilikuvio miehille")
qqline(terveys.m$bmi)
# Normaalikvantiilikuviot naisille
qqnorm(terveys.n$bmi, main = "Normaalikvantiilikuvio naisille")
qqline(terveys.n$bmi)
# Normaalikvantiilikuviot miehille ja naisille erikseen
par(mfrow=c(2,1))
qqnorm(terveys.m$bmi, main = "Normaalikvantiilikuvio miehille")
qqline(terveys.m$bmi)
qqnorm(terveys.n$bmi, main = "Normaalikvantiilikuvio naisille")
qqline(terveys.n$bmi)
# Normaalikvantiilikuviot kaikille
qqnorm(terveys$bmi, main="Normaalikvantiilikuvio kaikkien havaintojen bmi")
qqline(terveys$bmi)
# Normaalikvantiilikuviot kaikille
qqnorm(terveys$bmi, main="Normaalikvantiilikuvio kaikkien havaintojen bmi")
qqline(terveys$bmi)
# Normaalikvantiilikuviot miehille ja naisille erikseen
par(mfrow=c(2,1))
qqnorm(terveys.m$bmi, main = "Normaalikvantiilikuvio miesten bmi")
qqline(terveys.m$bmi)
qqnorm(terveys.n$bmi, main = "Normaalikvantiilikuvio naisten bmi")
qqline(terveys.n$bmi)
terveys <- read.csv("C:/Users/Marko/OneDrive - O365 Turun yliopisto/UTU/Tilastollisen päättelyn peruskurssi/viikko1/terveys.csv",sep=";")
View(terveys)
terveys$bmi  <- terveys$paino/(terveys$pituus/100)^2
terveys.m <- subset(terveys, sukupuoli =="Mies")
terveys.n <- subset(terveys, sukupuoli =="Nainen")
terveys <- read.csv("C:/Users/Marko/OneDrive - O365 Turun yliopisto/UTU/Tilastollisen päättelyn peruskurssi/viikko1/terveys.csv",sep=";")
View(terveys)
terveys$bmi  <- terveys$paino/(terveys$pituus/100)^2
View(terveys)
plot(terveys$ika, terveys$kolesteroli)
plot(terveys$bmi, terveys$kolesteroli)
plot(terveys$ika, terveys$kolesteroli)
isapoika <- read.csv("C:/Users/Marko/OneDrive - O365 Turun yliopisto/UTU/Tilastollisen päättelyn peruskurssi/viikko3/isapoika.csv",sep=";")
View(isapoika)
isapoika <- read.csv("C:/Users/Marko/OneDrive - O365 Turun yliopisto/UTU/Tilastollisen päättelyn peruskurssi/viikko3/isapoika.csv",sep=",")
View(isapoika)
x <- isapoika $ isanpituus
y <- isapoika $ pojanpituus
help("lm")
PNS <- lm(y ~ x) # sovitetaan PNS - suora
PNS
plot (x ,y , xlab = " Isan ␣ pituus ␣ ( cm ) " , ylab = " Pojan ␣ pituus ␣ ( cm ) " )
plot (x ,y , xlab = " Isan pituus ( cm ) " , ylab = " Pojan pituus ( cm ) " )
plot (x ,y , xlab = "Isän pituus (cm)" , ylab = "Pojan pituus (cm)" )
terveys <- read.csv("C:/Users/Marko/OneDrive - O365 Turun yliopisto/UTU/Tilastollisen päättelyn peruskurssi/viikko1/terveys.csv",sep=";")
terveys$bmi  <- terveys$paino/(terveys$pituus/100)^2
plot(terveys$ika, terveys$kolesteroli, xlab = "Ikä", ylab = "Kolesteroli")
par(mfrow=c(2,1))
plot(terveys$ika, terveys$kolesteroli, xlab = "Ikä", ylab = "Kolesteroli")
plot(terveys$bmi, terveys$kolesteroli, xlab = "Ikä", ylab = "Kolesteroli")
par(mfrow=c(2,1))
plot(terveys$ika, terveys$kolesteroli, xlab = "Ikä", ylab = "Kolesteroli")
plot(terveys$bmi, terveys$kolesteroli, xlab = "bmi", ylab = "Kolesteroli")
# Ikä / Kolesteroli -kuvaaja
plot(terveys$ika, terveys$kolesteroli, xlab = "Ikä", ylab = "Kolesteroli")
abline(lm(terveys$kolesteroli ~ terveys$ika))
# BMI / Kolesteroli -kuvaaja
plot(terveys$bmi, terveys$kolesteroli, xlab = "BMI", ylab = "Kolesteroli")
abline(lm(terveys$kolesteroli ~ terveys$bmi))
# Ikä-Kolesteroli-kuvaaja
plot(terveys$ika, terveys$kolesteroli, xlab = "Ikä", ylab = "Kolesteroli")
abline(lm(terveys$kolesteroli ~ terveys$ika))
# BMI-Kolesteroli-kuvaaja
plot(terveys$bmi, terveys$kolesteroli, xlab = "BMI", ylab = "Kolesteroli")
abline(lm(terveys$kolesteroli ~ terveys$bmi))
# Ikä-Kolesteroli ja BMI-Kolesteroli -otoskorrelaatiokertoimet
cor(terveys$ika, terveys$kolesteroli)
cor(terveys$bmi, terveys$kolesteroli)
# Ikä-Kolesteroli-hajontakuvio
plot(terveys$ika, terveys$kolesteroli, xlab = "Ikä", ylab = "Kolesteroli")
abline(lm(terveys$kolesteroli ~ terveys$ika))
lm(terveys$kolesteroli ~ terveys$bmi)
lm(terveys$kolesteroli ~ terveys$ika)
x <- c(1,2,3,4,5,6,7,8,9)
y <- c(1,2,3,4,5,6,7,8,9)
plot(x, y)
plot(x, y)
abline(lm(x~y))
x <- c(1,2,3,4,5,6,7,8,9)
y <- x^2
plot(x, y)
x <- c(1,2,3,4,5,6,7,8,9)
y <- x^6
plot(x, y)
abline(lm(x~y))
x <- c(1:100)
y <- x^2
plot(x, y)
x <- c(1:100)
y <- x^3
plot(x, y)
x <- c(1:100)
y <- x^6
plot(x, y)
abline(lm(x~y))
x <- c(1:100)
y <- exp(x)
plot(x, y)
x <- c(1:1000)
y <- exp(x)
x <- c(1:100)
y <- x^2
plot(x, y)
lm(x~y)
abline(lm(x~y))
x <- c(1:100)
y <- x^5
plot(x, y)
x <- c(1:100)
y <- x^12
plot(x, y)
lm(x~y)
abline(lm(x~y))
x <- c(1:100)
y <- x
plot(x, y)
x <- c(1:100)
y = x^2
plot(x,y)
abline(lm(x~y))
plot(x,y)
abline(lm(x ~ y))
x <- c(1:100)
y <- x
for(val in y){
if(val %% 2 == 0){
val <- -val
}
}
x <- c(1:100)
y <- x
for(val in y){
if(val %% 2 == 0){
val <- val * 2
}
}
x <- c(1:100)
y <- x
for(i in 1:100){
if(y[i] %% 2 == 0){
y[i] <- -i
}
}
plot(x, y)
lm(x~y)
abline(lm(x~y))
mean(y)
x <- c(1:100)
y <- x
for(i in 1:100){
if(y[i] %% 2 == 0){
y[i] <- -i
}
}
plot(x, y)
lm(y~x)
abline(lm(x~y))
abline(lm(y~x))
x <- c(1:100)
y = x^2
plot(x,y)
abline(lm(y ~ x))
x <- c(1:100)
y <- x
for(i in 1:100){
if(y[i] %% 2 == 0){
y[i] <- -i
}
}
plot(x, y)
lm(y~x)
abline(lm(y~x))
x <- c(1:100)
y = x^2
plot(x,y)
abline(lm(y ~ x))
x <- c(1:100)
y = x
plot(x,y)
abline(lm(y ~ x))
cor(x,y)
x <- c(1:100)
y <- x
for(i in 1:100){
if(y[i] %% 2 == 0){
y[i] <- -i
}
}
plot(x, y)
lm(y~x)
abline(lm(y~x))
cor(x,y)
x <- c(1:100)
y = x^4
plot(x,y)
abline(lm(y ~ x))
cor(x,y)
x <- c(42.5, 50.2, 49.0, 44.3, 44.8, 48.1, 46.3 ja 44.0)
x <- c(42.5, 50.2, 49.0, 44.3, 44.8, 48.1, 46.3, 44.0)
mean(x)
sd(x)
help("qt")
qt(0.975, 7)
qt(1 - 0.025, 16 - 1)
pt(2.667, 15)
pt(2.667, 16 - 1)
pchisq(2.04, 3 - 1)
f <- c(44, 58, 98)
chisq.test(f)
e <- c(50, 50, 100)
h <- sum((f - e)^2 / e)
h
p <- 1- pchisq(h, 2)
p
x <- c(1:100)
x[seq(from=2, to=(length(x), by=2))]
x[seq(from=2, to=length(x), by=2)]
x[seq(from=3, to=length(x), by=3)]
x[seq(from=1, to=length(x), by=3)]
setwd("D:/Seafile/UTU/Tilastotieteen harjoitustyö 2021")
library(foreign)
ht1.dat <- read.spss("elinolo2020.sav", to.data.frame = TRUE)
attach(ht1.dat)
set.seed(518467)
oma.otos1 <- ht1.dat[sample(nrow(ht1.dat), 700)]
attach(oma.otos1)
oma.otos1 <- ht1.dat[sample(nrow(ht1.dat), 700),]
attach(oma.otos1)
miehet.dat <- select(filter(oma.otos1, supu=="mies"), c(supu, ahtas, pala))
help select
help(select)
library(dplyr)
miehet.dat <- select(filter(oma.otos1, supu=="mies"), c(supu, ahtas, pala))
naiset <- select(filter(oma.otos1, supu=="nainen"), c(supu, ahtas, pala))
naiset.dat <- select(filter(oma.otos1, supu=="nainen"), c(supu, ahtas, pala))
View(naiset)
View(naiset.dat)
View(naiset.dat)
# Shapiro-Wilk -testit, miehet
with(miehet.dat, tapply(pala, list(ahtas), shapiro.test))
with(naiset.dat, tapply(pala, list(ahtas), shapiro.test))
View(miehet.dat)
View(miehet.dat)
attach (miehet.dat)
boxplot(pala~ahtas)
detach (miehet.dat)
attach (naiset.dat)
boxplot(pala~ahtas)
detach (naiset.dat)
View(naiset.dat)
# hajontojen yhtäsuuruustestaus
attach(oma.otos1)
library(car)
leveneTest(pala~supu*ahtas)
#Kaksisuuntainen varianssianalyysi
anova(lm(pala~supu*ahtas))
# sirontakuvio, kotitalouden kuluttajayksiköiden lukumäärä
plot(rkyks, pala)
abline(lm(pala~rkyks))
View(oma.otos1)
View(oma.otos1)
# sirontakuvio, asumismenot
plot(asmenot, pala)
abline(lm(pala~asmenot))
View(oma.otos1)
# sirontakuvio, asumismenot
plot(alaika, pala)
abline(lm(pala~alaika))
# sirontakuvio, kotitalouden kuluttajayksiköiden lukumäärä
plot(rkyks, pala)
abline(lm(pala~rkyks))
# sirontakuvio, asumismenot
plot(asmenot, pala)
abline(lm(pala~asmenot))
# sirontakuvio, kotitalouden kuluttajayksiköiden lukumäärä
plot(rkyks, pala)
abline(lm(pala~rkyks))
# sirontakuvio, asumismenot
plot(alaika, pala)
abline(lm(pala~alaika))
# sirontakuvio, kotitalouden kuluttajayksiköiden lukumäärä
plot(rkyks, pala)
abline(lm(pala~rkyks))
# sirontakuvio, asumismenot
plot(asmenot, pala)
abline(lm(pala~asmenot))
# sirontakuvio, asumismenot
plot(alaika, pala)
abline(lm(pala~alaika))
# korrelaatiokertoimet
cor.test(rkyks, pala, method="pearson")
cor.test(rkyks, pala, method="spearman")
# korrelaatiokertoimet
cor.test(rkyks, pala, method="pearson")
cor.test(rkyks, pala, method="spearman")
cor.test(asmenot, pala, method="pearson")
cor.test(asmenot, pala, method="spearman")
cor.test(alaika, pala, method="pearson")
cor.test(alaika, pala, method="spearman")
cor.test(rkyks, pala, method="spearman", exact=FALSE)
cor.test(asmenot, pala, method="pearson")
cor.test(asmenot, pala, method="spearman", exact=FALSE)
cor.test(alaika, pala, method="pearson")
cor.test(alaika, pala, method="spearman", exact=FALSE)
# regressiomalli
lm.pala <- lm(pala~rkyks+asmenot)
summary(lm.pala)
# regressiomalli
lm.pala <- lm(pala~rkyks+asmenot~alaika)
# regressiomalli
lm.pala <- lm(pala~rkyks+asmenot+alaika)
# kolmen selittäjän regressiomalli
lm.pala <- lm(pala~rkyks+asmenot+alaika)
summary(lm.pala)
